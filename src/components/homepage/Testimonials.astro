---
const testimonialData = [
  {
    name: "Valerie Savard",
    from: "Revue Moebius",
    message:
      "Since its launch, the number of site visits has significantly increased, the number of sales made through the website has doubled, and we have given several interviews regarding the unique integration of hypermedia literature works in the site, notably for the Carnet de la Fabrique du numerique, which provides insights into innovations in the world of digital literary and scientific publishing.",
  },
  {
    name: "Danilo Flores",
    from: "Mimotype Technologies GmbH",
    message:
      "Andrew brings an artisanal outlook and an uncompromising professionalism to the table. He created a website for our company, fully hitting the mark in terms of aesthetics and functionality. Working seamlessly together with another contractor, Andrew gracefully orchestrated the maturation of the end product among multiple parties. We enjoyed our spirited exchanges and are looking forward to doing business again, having full trust in his ability and diligence!",
  },
  {
    name: "M (Assistant Director)",
    from: "Expos√© Noir",
    message:
      "Andrew is a true professional who was great at understanding our particular needs and finding solutions to make sure we were fully satisfied with our website. He is highly responsive, even while on the road, and always a pleasure to work with. You won't be disappointed by his results.",
  },
  {
    name: "Valerie Savard",
    from: "Revue Moebius",
    message:
      "Since its launch, the number of site visits has significantly increased, the number of sales made through the website has doubled, and we have given several interviews regarding the unique integration of hypermedia literature works in the site, notably for the Carnet de la Fabrique du numerique, which provides insights into innovations in the world of digital literary and scientific publishing.",
  },
  {
    name: "Valerie Savard",
    from: "Revue Moebius",
    message:
      "Since its launch, the number of site visits has significantly increased, the number of sales made through the website has doubled, and we have given several interviews regarding the unique integration of hypermedia literature works in the site, notably for the Carnet de la Fabrique du numerique, which provides insights into innovations in the world of digital literary and scientific publishing.",
  },
];

const length = testimonialData.length;
---

<div class="testimonial-wrapper">
  <div class="testimonial-inner">
    <div class="header">
      <h3 data-length={length}>Friendly Notes</h3>
    </div>
    <div class="notes" data-lenis-prevent>
      {
        testimonialData.map((note, index) => {
          return (
            <div class="note-wrapper" data-note-index={index}>
              <div class="note-inner">
                <div class="icon">
                  <p>{note.name.slice(0, 1)}</p>
                </div>
                <div class="note-text">
                  <h6>
                    {note.name} &#8226; {note.from}
                  </h6>
                  <small class="note-message" data-note-message={note.message}>
                    {note.message}
                  </small>
                </div>
              </div>
            </div>
          );
        })
      }
    </div>
  </div>
</div>

<script>
  // Get all note wrapper elements
  const noteWrappers = document.querySelectorAll(".note-wrapper");

  // Add event listener to each note wrapper
  noteWrappers.forEach((noteWrapper) => {
    noteWrapper.addEventListener("click", toggleNote);
  });

  // Toggle the note's visibility
  function toggleNote() {
    const noteMessageElement = this.querySelector(".note-message");
    noteMessageElement.classList.toggle("open");

    // Toggle the background color of note-wrapper
    this.classList.toggle("open");
  }
</script>

<style lang="scss">
  .testimonial-wrapper {
    background: var(--white);
    height: 100%;
    position: relative;
  }
  .testimonial-inner {
    width: 100%;
    height: 100%;
    margin: 0 auto;
    padding: 5rem 0;
    padding-top: 1rem;
    overflow: hidden;
    position: relative;
  }
  .header {
    position: absolute;
    z-index: 3;
    top: 0;
    left: 0;
    width: 100%;
    padding: 1.5rem 5%;
    padding-top: 3rem;
    background-color: #ffffff20;
    -webkit-backdrop-filter: blur(40px);
    backdrop-filter: blur(40px);
    border-bottom: 2px solid var(--grey-100);

    h3 {
      width: 90%;
      margin: 0 auto;
      display: flex;
      justify-content: flex-start;
      align-items: center;
    }
    h3:before {
      display: inline-flex;
      justify-content: center;
      align-items: center;
      content: attr(data-length);
      color: var(--white);
      background: #f42152;
      border-radius: 100%;
      margin-right: 1.5rem;
      margin-bottom: 0.25rem;
      aspect-ratio: 1/1;
      width: 47px;
      height: 47px;
      font-size: 20px;
    }
  }
  .notes {
    width: 90%;
    margin: 2rem auto;
    margin-top: 0rem;
    padding-bottom: 5rem;
    overflow: auto;
    height: 100%;
    scrollbar-width: thin;
    scrollbar-color: transparent transparent;
    user-select: none;

    &::after {
      bottom: 0;
      left: 0;
      position: absolute;
      content: "";
      width: 100%;
      height: 3rem;
      background: linear-gradient(
        180deg,
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 0.75) 49.48%,
        #fff 100%,
        #fff 100%
      );
    }
  }

  .note-wrapper {
    width: 90%;
    margin: 0.5rem auto;
    border-radius: 10px;
    transition: var(--hover-transition);
    border: 1px solid transparent;

    &:first-child {
      margin-top: 9rem;
    }

    &.open {
      background: var(--grey-100);
      border: 1px solid var(--grey-200);
    }
  }

  .note-wrapper:hover {
    background: var(--grey-100);
    cursor: pointer;
  }

  .note-inner {
    display: flex;
    justify-content: flex-start;
    padding: 1.25rem 1.5rem;
    margin: 1rem auto;
  }

  .icon {
    border-radius: 5px;
    background: var(--grey-300);
    color: var(--white);
    padding: 1rem;
    aspect-ratio: 1/1;
    width: 60px;
    height: 60px;
    text-align: center;
    p {
      transform: translateY(2px);
      line-height: 100%;
    }
  }
  .note-text {
    margin: 0 2rem;

    small {
      margin-top: 0.5rem;
      color: var(--grey-300);
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      max-height: 150%;
      line-height: 150%;
      transition: var(--hover-transition);
      &.open {
        overflow: visible;
        text-overflow: unset;
        display: block;
      }
    }
  }

  @media (max-width: 992px) {
    .testimonial-wrapper {
      margin-bottom: 1rem;
    }
  }
  @media (max-width: 576px) {
    .testimonial-inner {
      padding: 2rem 0;
    }
    .header {
      padding: 2rem .5rem;
      padding-bottom: 1rem;


      h3:before {
        font-size: 14px;
        width: 30px;
        height: 30px;
        margin-right: 1rem;
      }
    }
    .notes {
      margin-top: 0rem;
      padding-bottom: 1rem;
    }
    .note-wrapper {
      width: 100%;
      &:first-child {
        margin-top: 4rem;
      }
    }
    .icon {
      width: 48px;
      height: 48px;
    }
    .note-inner {
      margin: 0.25rem 0;
      padding: 0.75rem 0.5rem;
    }
    .note-text {
      margin: 0 1rem;
      small {
        font-size: 12px;
        line-height: 160%;
      }
    }
  }
</style>
